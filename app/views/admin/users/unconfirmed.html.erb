<h2>Unconfirmed Members</h2>

<p><%= link_to 'Confirmed accounts', admin_users_path %></p>

<p>There are currently <%= pluralize(User.unconfirmed.count, 'unconfirmed member') %></p>

<%= form_tag nil, method: :get do %>
  <%= text_field_tag :q, params[:q] %>
  <%= submit_tag 'Search' %>
<% end %>

<table class="table">
  <tr>
    <th>Name</th>
    <th class="d-none d-lg-table-cell">Email</th>
    <th class="d-none d-sm-table-cell">Unconfirmed Duration</th>
    <th class="d-none d-md-table-cell">Confirmation Info</th>
    <th>Delete</th>
  </tr>
  <% @users.each do |user| %>
    <% cache user do %>
      <tr>
        <td class="align-middle"><%= user.name %></td>
        <td class="d-none d-lg-table-cell align-middle"><%= user.email %></td>
        <td class="d-none d-sm-table-cell align-middle"><%= distance_of_time_in_words(user.created_at.to_time - Time.now.utc) %></td>
        <td class="d-none d-md-table-cell align-middle text-center">
          <% if user.confirmation_period_expired? %>
            <%= button_to 'Resend', resend_email_admin_user_path(user), method: :post, class: "btn btn-primary align-middle" %>
          <% else %>
            Last confirmation sent <%= distance_of_time_in_words(user.confirmation_sent_at.to_time - Time.now.utc) %> ago
          <% end %>
        </td>
        <td class="align-middle text-center">
          <%= button_to 'Delete', admin_user_path(user), method: :delete, data: {confirm: 'Are you sure? This is irreversible'}, class: "btn btn-danger" %>
        </td>
      </tr>
    <% end %>
  <% end %>
</table>

<%= paginate @users, theme: 'twitter-bootstrap-4' %>
